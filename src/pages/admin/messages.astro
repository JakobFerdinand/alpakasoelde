---
import Layout from '../../layouts/Layout.astro';
---

<Layout title="Nachrichten">
  <section class="admin-page section">
    <div class="container">
      <h2>Eingegangene Nachrichten</h2>
      <ul class="message-list" id="message-list">
        <li>Lade Nachrichten...</li>
      </ul>
    </div>
  </section>
</Layout>

<script>
  async function loadMessages() {
    try {
      const res = await fetch('/api/get-messages');
      if (!res.ok) return;
      const msgs = await res.json();
      const list = document.getElementById('message-list');
      list.innerHTML = '';
      msgs.forEach((msg) => {
        const li = document.createElement('li');
        li.classList.add('message');
        li.innerHTML = `<h3>${msg.name} <span class="email">(${msg.email})</span></h3><p>${msg.message}</p>`;
        list.appendChild(li);
      });
    } catch {
      /* ignore */
    }
  }
  loadMessages();
</script>

<style>
  .admin-page {
    background-color: var(--seafoam-mist);
    color: var(--slate-river);
  }

  .message-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .message {
    background: var(--vanilla-cream);
    color: var(--slate-river);
    padding: 1rem;
    border-radius: 0.5rem;
    margin-bottom: 1rem;
  }

  .email {
    font-weight: normal;
    font-size: 0.875rem;
  }
</style>
